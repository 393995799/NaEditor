{"remainingRequest":"D:\\Project\\NaEditor\\node_modules\\babel-loader\\lib\\index.js!D:\\Project\\NaEditor\\node_modules\\thread-loader\\dist\\cjs.js!D:\\Project\\NaEditor\\src\\db\\createStore.js","dependencies":[{"path":"D:\\Project\\NaEditor\\src\\db\\createStore.js","mtime":1535090146000},{"path":"D:\\Project\\NaEditor\\.babelrc","mtime":1535117171942},{"path":"D:\\Project\\NaEditor\\node_modules\\cache-loader\\dist\\cjs.js","mtime":0},{"path":"D:\\Project\\NaEditor\\node_modules\\babel-loader\\lib\\index.js","mtime":1520329890000},{"path":"D:\\Project\\NaEditor\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000}],"contextDependencies":[],"result":["let updateModule = (() => {\n    var _ref = _asyncToGenerator(function* (db) {\n\n        // const data = [{\n        //     moduleTypeId: 1,\n        //     moduleName: '自定321义代码模块',\n        //     data: {\n        //         code: `<style>div{color:red;}</style>\n        //         <div class=\"a\">dsf</div>`\n        //     }\n        // }, {\n        //     moduleTypeId: 2,\n        //     moduleName: '图片热区模块',\n        //     data: {\n        //         imgSrc: `https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=2141015511,3653211916&fm=58&bpow=400&bpoh=400`\n        //     }\n        // }]\n\n        const StoreName = 'module';\n        if (!Array.from(db.objectStoreNames).includes(StoreName)) {\n            const objectStore = db.createObjectStore(StoreName, { keyPath: \"moduleId\", autoIncrement: true });\n            objectStore.createIndex('moduleName', 'moduleName', { unique: false });\n            objectStore.createIndex('moduleTypeId', 'moduleTypeId', { unique: false });\n        }\n    });\n\n    return function updateModule(_x) {\n        return _ref.apply(this, arguments);\n    };\n})();\n\nlet updatePage = (() => {\n    var _ref2 = _asyncToGenerator(function* (db) {\n        const StoreName = 'page';\n        if (!Array.from(db.objectStoreNames).includes(StoreName)) {\n            const objectStore = db.createObjectStore(StoreName, { keyPath: \"pageId\", autoIncrement: true });\n            objectStore.createIndex('pageName', 'pageName', { unique: false });\n        }\n    });\n\n    return function updatePage(_x2) {\n        return _ref2.apply(this, arguments);\n    };\n})();\n\n(function () {\n    var enterModule = require('react-hot-loader').enterModule;\n\n    enterModule && enterModule(module);\n})();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nimport idb from 'idb';\nimport DB from '../db/dbConfig';\nimport './dataInitial';\n\nconst DB_VERSION = DB.Version;\n\nvar DBOpenRequest = window.indexedDB.open(DB.Name, DB_VERSION);\n\nDBOpenRequest.onupgradeneeded = e => {\n    const db = e.target.result;\n    const func = [updateModuleName, updateModule, updatePage];\n    func.forEach(func => {\n        try {\n            func(db);\n        } catch (e) {\n            console.log(e);\n        }\n    });\n};\n\nfunction updateModuleName(db) {\n    // const data = [{\n    //     moduleName: '自定义代码',\n    // }, {\n    //     moduleName: '图片热区',\n    // }];\n\n    const StoreName = 'moduleName';\n    if (!Array.from(db.objectStoreNames).includes(StoreName)) {\n        const objectStore = db.createObjectStore(StoreName, { keyPath: \"moduleTypeId\", autoIncrement: true });\n        objectStore.createIndex('moduleTypeId', 'moduleTypeId', { unique: true });\n        objectStore.createIndex('moduleName', 'moduleName', { unique: false });\n    }\n\n    // data.forEach(v => {\n    //     objectStore.add(v);\n    // })\n}\n\n;\n\n(function () {\n    var reactHotLoader = require('react-hot-loader').default;\n\n    var leaveModule = require('react-hot-loader').leaveModule;\n\n    if (!reactHotLoader) {\n        return;\n    }\n\n    reactHotLoader.register(DB_VERSION, 'DB_VERSION', 'D:/Project/NaEditor/src/db/createStore.js');\n    reactHotLoader.register(DBOpenRequest, 'DBOpenRequest', 'D:/Project/NaEditor/src/db/createStore.js');\n    reactHotLoader.register(updateModuleName, 'updateModuleName', 'D:/Project/NaEditor/src/db/createStore.js');\n    reactHotLoader.register(updateModule, 'updateModule', 'D:/Project/NaEditor/src/db/createStore.js');\n    reactHotLoader.register(updatePage, 'updatePage', 'D:/Project/NaEditor/src/db/createStore.js');\n    leaveModule(module);\n})();\n\n;",{"version":3,"sources":["src\\db\\createStore.js"],"names":["db","StoreName","Array","from","objectStoreNames","includes","objectStore","createObjectStore","keyPath","autoIncrement","createIndex","unique","updateModule","updatePage","idb","DB","DB_VERSION","Version","DBOpenRequest","window","indexedDB","open","Name","onupgradeneeded","e","target","result","func","updateModuleName","forEach","console","log"],"mappings":";iCAyCA,WAA4BA,EAA5B,EAAgC;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAMC,YAAY,QAAlB;AACA,YAAI,CAACC,MAAMC,IAAN,CAAWH,GAAGI,gBAAd,EAAgCC,QAAhC,CAAyCJ,SAAzC,CAAL,EAA0D;AACtD,kBAAMK,cAAcN,GAAGO,iBAAH,CAAqBN,SAArB,EAAgC,EAAEO,SAAS,UAAX,EAAuBC,eAAe,IAAtC,EAAhC,CAApB;AACAH,wBAAYI,WAAZ,CAAwB,YAAxB,EAAsC,YAAtC,EAAoD,EAAEC,QAAQ,KAAV,EAApD;AACAL,wBAAYI,WAAZ,CAAwB,cAAxB,EAAwC,cAAxC,EAAwD,EAAEC,QAAQ,KAAV,EAAxD;AACH;AAGJ,K;;oBAzBcC,Y;;;;;;kCA2Bf,WAA0BZ,EAA1B,EAA8B;AAC1B,cAAMC,YAAY,MAAlB;AACA,YAAI,CAACC,MAAMC,IAAN,CAAWH,GAAGI,gBAAd,EAAgCC,QAAhC,CAAyCJ,SAAzC,CAAL,EAA0D;AACtD,kBAAMK,cAAcN,GAAGO,iBAAH,CAAqBN,SAArB,EAAgC,EAAEO,SAAS,QAAX,EAAqBC,eAAe,IAApC,EAAhC,CAApB;AACAH,wBAAYI,WAAZ,CAAwB,UAAxB,EAAoC,UAApC,EAAgD,EAAEC,QAAQ,KAAV,EAAhD;AACH;AACJ,K;;oBANcE,U;;;;;;;;;;;;;AApEf,OAAOC,GAAP,MAAgB,KAAhB;AACA,OAAOC,EAAP,MAAe,gBAAf;AACA,OAAO,eAAP;;AAEA,MAAMC,aAAaD,GAAGE,OAAtB;;AAGA,IAAIC,gBAAgBC,OAAOC,SAAP,CAAiBC,IAAjB,CAAsBN,GAAGO,IAAzB,EAA+BN,UAA/B,CAApB;;AAEAE,cAAcK,eAAd,GAAiCC,CAAD,IAAO;AACnC,UAAMxB,KAAKwB,EAAEC,MAAF,CAASC,MAApB;AACA,UAAMC,OAAO,CAACC,gBAAD,EAAmBhB,YAAnB,EAAiCC,UAAjC,CAAb;AACAc,SAAKE,OAAL,CAAaF,QAAQ;AACjB,YAAI;AACAA,iBAAK3B,EAAL;AACH,SAFD,CAEE,OAAOwB,CAAP,EAAU;AACRM,oBAAQC,GAAR,CAAYP,CAAZ;AACH;AACJ,KAND;AAOH,CAVD;;AAaA,SAASI,gBAAT,CAA0B5B,EAA1B,EAA8B;AAC1B;AACA;AACA;AACA;AACA;;AAEA,UAAMC,YAAY,YAAlB;AACA,QAAI,CAACC,MAAMC,IAAN,CAAWH,GAAGI,gBAAd,EAAgCC,QAAhC,CAAyCJ,SAAzC,CAAL,EAA0D;AACtD,cAAMK,cAAcN,GAAGO,iBAAH,CAAqBN,SAArB,EAAgC,EAAEO,SAAS,cAAX,EAA2BC,eAAe,IAA1C,EAAhC,CAApB;AACAH,oBAAYI,WAAZ,CAAwB,cAAxB,EAAwC,cAAxC,EAAwD,EAAEC,QAAQ,IAAV,EAAxD;AACAL,oBAAYI,WAAZ,CAAwB,YAAxB,EAAsC,YAAtC,EAAoD,EAAEC,QAAQ,KAAV,EAApD;AACH;;AAED;AACA;AACA;AACH;;;;;;;;;;;;;4BAnCKK,U;4BAGFE,a;4BAeKU,gB;4BAmBMhB,Y;4BA2BAC,U","file":"createStore.js","sourceRoot":"D:/Project/NaEditor","sourcesContent":["import idb from 'idb';\nimport DB from '../db/dbConfig';\nimport './dataInitial';\n\nconst DB_VERSION = DB.Version;\n\n\nvar DBOpenRequest = window.indexedDB.open(DB.Name, DB_VERSION);\n\nDBOpenRequest.onupgradeneeded = (e) => {\n    const db = e.target.result;\n    const func = [updateModuleName, updateModule, updatePage];\n    func.forEach(func => {\n        try {\n            func(db);\n        } catch (e) {\n            console.log(e);\n        }\n    })\n}\n\n\nfunction updateModuleName(db) {\n    // const data = [{\n    //     moduleName: '自定义代码',\n    // }, {\n    //     moduleName: '图片热区',\n    // }];\n\n    const StoreName = 'moduleName';\n    if (!Array.from(db.objectStoreNames).includes(StoreName)) {\n        const objectStore = db.createObjectStore(StoreName, { keyPath: \"moduleTypeId\", autoIncrement: true });\n        objectStore.createIndex('moduleTypeId', 'moduleTypeId', { unique: true });\n        objectStore.createIndex('moduleName', 'moduleName', { unique: false });\n    }\n\n    // data.forEach(v => {\n    //     objectStore.add(v);\n    // })\n}\n\nasync function updateModule(db) {\n\n    // const data = [{\n    //     moduleTypeId: 1,\n    //     moduleName: '自定321义代码模块',\n    //     data: {\n    //         code: `<style>div{color:red;}</style>\n    //         <div class=\"a\">dsf</div>`\n    //     }\n    // }, {\n    //     moduleTypeId: 2,\n    //     moduleName: '图片热区模块',\n    //     data: {\n    //         imgSrc: `https://ss0.baidu.com/6ONWsjip0QIZ8tyhnq/it/u=2141015511,3653211916&fm=58&bpow=400&bpoh=400`\n    //     }\n    // }]\n\n    const StoreName = 'module';\n    if (!Array.from(db.objectStoreNames).includes(StoreName)) {\n        const objectStore = db.createObjectStore(StoreName, { keyPath: \"moduleId\", autoIncrement: true });\n        objectStore.createIndex('moduleName', 'moduleName', { unique: false });\n        objectStore.createIndex('moduleTypeId', 'moduleTypeId', { unique: false });\n    }\n\n\n}\n\nasync function updatePage(db) {\n    const StoreName = 'page';\n    if (!Array.from(db.objectStoreNames).includes(StoreName)) {\n        const objectStore = db.createObjectStore(StoreName, { keyPath: \"pageId\", autoIncrement: true });\n        objectStore.createIndex('pageName', 'pageName', { unique: false });\n    }\n}"]}]}