{"remainingRequest":"D:\\Project\\NaEditor\\node_modules\\awesome-typescript-loader\\dist\\entry.js!D:\\Project\\NaEditor\\node_modules\\thread-loader\\dist\\cjs.js!D:\\Project\\NaEditor\\src\\component\\ModuleWrap\\ModuleWrap.tsx","dependencies":[{"path":"D:\\Project\\NaEditor\\src\\component\\ModuleWrap\\ModuleWrap.tsx","mtime":1535279960119},{"path":"D:\\Project\\NaEditor\\src\\component\\ModuleWrap\\ModuleWrap.tsx","mtime":1535279960119},{"path":"D:\\Project\\NaEditor\\src\\component\\interface.tsx","mtime":1535210015291},{"path":"D:\\Project\\NaEditor\\src\\component\\CarouselConfig\\interface.ts","mtime":1533698584000},{"path":"D:\\Project\\NaEditor\\src\\component\\ImageHotspotConfig\\interface.tsx","mtime":1533698584000},{"path":"D:\\Project\\NaEditor\\src\\actions\\index.js","mtime":1535277057061},{"path":"D:\\Project\\NaEditor\\src\\common\\script\\action.ts","mtime":1535214522899},{"path":"D:\\Project\\NaEditor\\node_modules\\axios\\index.d.ts","mtime":1519077740000},{"path":"D:\\Project\\NaEditor\\src\\common\\script\\INTERFACE.ts","mtime":1535297432808},{"path":"D:\\Project\\NaEditor\\src\\db\\dbConfig.js","mtime":1533698584000},{"path":"D:\\Project\\NaEditor\\node_modules\\idb\\lib\\idb.d.ts","mtime":1520276302000},{"path":"D:\\Project\\NaEditor\\node_modules\\localforage\\typings\\localforage.d.ts","mtime":1529170699000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\version\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\upload\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\upload\\Dragger.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\upload\\interface.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\react\\index.d.ts","mtime":1532389452000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\react\\global.d.ts","mtime":1532389452000},{"path":"D:\\Project\\NaEditor\\node_modules\\csstype\\index.d.ts","mtime":1532213362000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\upload\\Upload.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\upload\\utils.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\mention\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tooltip\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tooltip\\placements.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\timeline\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\timeline\\TimelineItem.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\timeline\\Timeline.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\time-picker\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\moment\\moment.d.ts","mtime":1527836312000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tag\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tag\\CheckableTag.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tabs\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tree-select\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\select\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tree-select\\interface.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tree\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tree\\DirectoryTree.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\tree\\Tree.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\transfer\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\transfer\\search.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\transfer\\operation.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\transfer\\list.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\table\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\table\\interface.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\pagination\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\pagination\\Pagination.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\checkbox\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\checkbox\\Group.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\checkbox\\Checkbox.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\radio\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\radio\\interface.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\radio\\radioButton.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\radio\\group.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\radio\\radio.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\table\\createStore.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\spin\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\table\\Table.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\table\\ColumnGroup.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\table\\Column.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\switch\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\steps\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\slider\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\row\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\grid\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\grid\\col.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\grid\\row.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\rate\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\progress\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\progress\\progress.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\popover\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\popconfirm\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\button\\button.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\button\\button-group.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\notification\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\modal\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\modal\\ActionButton.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\modal\\Modal.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\menu\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\layout\\Sider.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\menu\\MenuItem.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\menu\\SubMenu.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\message\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\locale-provider\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\modal\\locale.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\list\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\list\\Item.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\layout\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\layout\\layout.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\input-number\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\_util\\type.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\input\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\input\\TextArea.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\input\\Search.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\input\\Input.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\input\\Group.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\icon\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\form\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\form\\FormItem.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\form\\Form.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\drawer\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\dropdown\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\dropdown\\dropdown-button.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\dropdown\\dropdown.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\divider\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\date-picker\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\date-picker\\interface.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\col\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\cascader\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\carousel\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\collapse\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\collapse\\CollapsePanel.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\collapse\\Collapse.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\card\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\card\\Meta.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\card\\Grid.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\calendar\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\calendar\\Header.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\button\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\breadcrumb\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\breadcrumb\\BreadcrumbItem.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\breadcrumb\\Breadcrumb.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\badge\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\badge\\ScrollNumber.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\back-top\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\avatar\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\alert\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\auto-complete\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\anchor\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\anchor\\AnchorLink.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\anchor\\Anchor.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\antd\\lib\\affix\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\index.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\util.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\string.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\seq.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\object.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\number.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\math.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\lang.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\function.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\date.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\collection.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\array.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\lodash\\common\\common.d.ts","mtime":1533259582000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\prop-types\\index.d.ts","mtime":1533863514000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\react-redux\\index.d.ts","mtime":1532389452000},{"path":"D:\\Project\\NaEditor\\node_modules\\@types\\react-redux\\node_modules\\redux\\index.d.ts","mtime":499162500000},{"path":"D:\\Project\\NaEditor\\node_modules\\cache-loader\\dist\\cjs.js","mtime":0},{"path":"D:\\Project\\NaEditor\\node_modules\\awesome-typescript-loader\\dist\\entry.js","mtime":1529596564000},{"path":"D:\\Project\\NaEditor\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000}],"contextDependencies":[],"result":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport { showConfig, focusModule, addModuleRequest, allModuleTopChange } from '../../actions';\r\nclass ModuleWrap extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.dragOver = (e) => {\r\n            const { nextPlaceholder, moduleData } = this.state;\r\n            const { moduleRef, allModuleTopChange } = this.props;\r\n            if (nextPlaceholder === undefined) {\r\n                const placeholder = document.createElement('div');\r\n                placeholder.className = 'd-next-placeholder';\r\n                placeholder.innerHTML = `松开鼠标模块会被放置到这里`;\r\n                this.setState({\r\n                    nextPlaceholder: placeholder,\r\n                }, () => {\r\n                    insertAfter(placeholder, moduleRef);\r\n                    window.resizeIframe();\r\n                    // 刷新本模块之后所有模块的top值 \r\n                    // TODO 有性能问题，暂时屏蔽\r\n                    // allModuleTopChange(moduleData.moduleId, placeholder.clientHeight);\r\n                });\r\n                function insertAfter(newEl, targetEl) {\r\n                    let parentEl = targetEl.parentNode;\r\n                    if (parentEl === null) {\r\n                        return;\r\n                    }\r\n                    if (parentEl.lastChild === targetEl) {\r\n                        parentEl.appendChild(newEl);\r\n                    }\r\n                    else {\r\n                        parentEl.insertBefore(newEl, targetEl.nextSibling);\r\n                    }\r\n                }\r\n            }\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        };\r\n        this.dragLeave = (e) => {\r\n            const { moduleData, nextPlaceholder } = this.state;\r\n            const { allModuleTopChange } = this.props;\r\n            let topChange = 0;\r\n            if (nextPlaceholder !== undefined) {\r\n                topChange = -nextPlaceholder.clientHeight;\r\n            }\r\n            // 本模块之后所有模块的top值还原\r\n            // TODO 有性能问题，暂时屏蔽\r\n            // allModuleTopChange(moduleData.moduleId, topChange);\r\n            this.clearNextPlaceholder();\r\n            e.stopPropagation();\r\n        };\r\n        /**\r\n         * 清除dragover时生成的占位元素\r\n         */\r\n        this.clearNextPlaceholder = () => {\r\n            const { nextPlaceholder } = this.state;\r\n            if (nextPlaceholder) {\r\n                nextPlaceholder.remove();\r\n            }\r\n            window.resizeIframe();\r\n            this.setState({\r\n                nextPlaceholder: undefined,\r\n            });\r\n        };\r\n        this.drop = (e) => __awaiter(this, void 0, void 0, function* () {\r\n            const { pageId } = this.context.BASE_DATA;\r\n            const moduleTypeId = Number.parseInt(e.dataTransfer.getData('moduleTypeId'), 10);\r\n            const { addModuleRequest } = this.props;\r\n            const preModuleId = this.state.moduleData.moduleId;\r\n            addModuleRequest({\r\n                preModuleId: preModuleId,\r\n                moduleTypeId,\r\n                pageId,\r\n            });\r\n            this.clearNextPlaceholder();\r\n            e.stopPropagation();\r\n        });\r\n        this.state = {\r\n            moduleData: props.moduleData,\r\n        };\r\n    }\r\n    render() {\r\n        const { moduleData, moduleData: { tempData, moduleId, }, moduleConfig: { isVisible: isConfigVisible, }, showConfig, focusModule } = this.props;\r\n        let isActive = false;\r\n        if (tempData) {\r\n            isActive = tempData.isActive;\r\n        }\r\n        return (React.createElement(\"div\", { className: `J_moduleWrap d-module-wrap ${isActive ? 'active' : ''}`, onClick: (e) => { showConfig(moduleData); if (!isActive) {\r\n                focusModule(moduleId);\r\n            } }, onDragOver: this.dragOver, onDragLeave: this.dragLeave, onDrop: this.drop, draggable: false }));\r\n    }\r\n}\r\nModuleWrap.contextTypes = {\r\n    BASE_DATA: PropTypes.object\r\n};\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        module: state.module,\r\n        moduleConfig: state.moduleConfig,\r\n    };\r\n};\r\nexport default connect(mapStateToProps, {\r\n    showConfig,\r\n    focusModule,\r\n    addModuleRequest,\r\n    allModuleTopChange,\r\n})(ModuleWrap);\r\n",{"version":3,"file":"D:/Project/NaEditor/src/component/ModuleWrap/ModuleWrap.tsx","sourceRoot":"D:/Project/NaEditor/","sources":["node_modules\\thread-loader\\dist\\cjs.js!D:\\Project\\NaEditor\\src\\component\\ModuleWrap\\ModuleWrap.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport _ from 'lodash';\n\nimport { showConfig, focusModule, addModuleRequest, allModuleTopChange } from '../../actions';\nimport { IModuleData, IModuleConfig, IState } from '../interface';\n\ninterface ModuleWrapProps {\n    moduleData: IModuleData;\n    moduleRef: HTMLElement;\n    addModuleRequest: any;\n    allModuleTopChange: any;\n    moduleConfig: IModuleConfig;\n    showConfig: any;\n    focusModule: any;\n}\n\ninterface ModuleWrapState {\n    moduleData: IModuleData;\n    nextPlaceholder?: HTMLDivElement;\n}\n\nclass ModuleWrap extends React.Component<ModuleWrapProps, ModuleWrapState> {\n\n    static contextTypes = {\n        BASE_DATA: PropTypes.object\n    }\n\n    constructor(props: ModuleWrapProps) {\n        super(props);\n\n        this.state = {\n            moduleData: props.moduleData,\n        };\n    }\n\n    dragOver = (e: React.DragEvent) => {\n        const { nextPlaceholder, moduleData } = this.state;\n        const { moduleRef, allModuleTopChange } = this.props;\n        if (nextPlaceholder === undefined) {\n            const placeholder = document.createElement('div');\n            placeholder.className = 'd-next-placeholder';\n            placeholder.innerHTML = `松开鼠标模块会被放置到这里`;\n            this.setState({\n                nextPlaceholder: placeholder,\n            }, () => {\n                insertAfter(placeholder, moduleRef);\n                (window as any).resizeIframe();\n\n                // 刷新本模块之后所有模块的top值 \n                // TODO 有性能问题，暂时屏蔽\n                // allModuleTopChange(moduleData.moduleId, placeholder.clientHeight);\n            });\n\n            function insertAfter(newEl: HTMLElement, targetEl: HTMLElement) {\n                let parentEl = targetEl.parentNode;\n                if (parentEl === null) {\n                    return;\n                }\n                if (parentEl.lastChild === targetEl) {\n                    parentEl.appendChild(newEl);\n                } else {\n                    parentEl.insertBefore(newEl, targetEl.nextSibling);\n                }\n            }\n        }\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    dragLeave = (e: React.DragEvent) => {\n        const { moduleData, nextPlaceholder } = this.state;\n        const { allModuleTopChange } = this.props;\n        let topChange = 0;\n        if (nextPlaceholder !== undefined) {\n            topChange = -nextPlaceholder.clientHeight;\n        }\n        // 本模块之后所有模块的top值还原\n        // TODO 有性能问题，暂时屏蔽\n        // allModuleTopChange(moduleData.moduleId, topChange);\n        this.clearNextPlaceholder();\n        e.stopPropagation();\n    }\n\n    /**\n     * 清除dragover时生成的占位元素\n     */\n    clearNextPlaceholder = () => {\n        const { nextPlaceholder } = this.state;\n        if (nextPlaceholder) {\n            nextPlaceholder.remove();\n        }\n        (window as any).resizeIframe();\n        this.setState({\n            nextPlaceholder: undefined,\n        });\n    }\n\n    drop = async (e: React.DragEvent) => {\n        const { pageId } = this.context.BASE_DATA;\n        const moduleTypeId = Number.parseInt(e.dataTransfer.getData('moduleTypeId'), 10);\n        const { addModuleRequest } = this.props;\n        const preModuleId = this.state.moduleData.moduleId;\n        addModuleRequest({\n            preModuleId: preModuleId,\n            moduleTypeId,\n            pageId,\n        });\n        this.clearNextPlaceholder();\n        e.stopPropagation();\n    }\n\n    render() {\n        const {\n            moduleData,\n            moduleData: {\n                tempData,\n                moduleId,\n            },\n            moduleConfig: {\n                isVisible: isConfigVisible,\n            },\n            showConfig,\n            focusModule } = this.props;\n        let isActive: boolean = false;\n        if (tempData) {\n            isActive = tempData.isActive;\n        }\n        return (\n            <div\n                className={`J_moduleWrap d-module-wrap ${isActive ? 'active' : ''}`}\n                onClick={(e) => { showConfig(moduleData); if (!isActive) { focusModule(moduleId); } }}\n                onDragOver={this.dragOver}\n                onDragLeave={this.dragLeave}\n                onDrop={this.drop}\n                draggable={false}\n            />\n        );\n    }\n\n}\n\nconst mapStateToProps = (state: IState) => {\n    return {\n        module: state.module,\n        moduleConfig: state.moduleConfig,\n    };\n};\n\nexport default connect(mapStateToProps, {\n    showConfig,\n    focusModule,\n    addModuleRequest,\n    allModuleTopChange,\n})(ModuleWrap);\n"]}]}